<div class="equipment-request-container">
  <div class="header-section">
    <h2>Request Equipment</h2>
    <p>Select equipment and specify the time period for your request.</p>
  </div>

  <div class="search-section">
    <igx-input-group type="search">
      <input igxInput [(ngModel)]="searchText" (ngModelChange)="onSearchChange()" placeholder="Search equipment..." />
      <label igxLabel>Search</label>
    </igx-input-group>
  </div>

  <igx-grid #grid 
            [data]="availableEquipment" 
            [allowFiltering]="true"
            [filterMode]="'excelStyleFilter'"
            height="400px"
            width="100%">
    
    <igx-column field="name" header="Name" [sortable]="true" [filterable]="true"></igx-column>
    <igx-column field="type" header="Type" [sortable]="true" [filterable]="true"></igx-column>
    <igx-column field="location" header="Location" [sortable]="true" [filterable]="true"></igx-column>
    <igx-column field="condition" header="Condition" [sortable]="true" [filterable]="true"></igx-column>
    <igx-column field="status" header="Status" [sortable]="true" [filterable]="true"></igx-column>
    
    <igx-column field="actions" header="Actions" [sortable]="false" [filterable]="false">
      <ng-template igxCell let-cell="cell">
        <button 
          igxButton="outlined" 
          igxRipple 
          (click)="openRequestDialog(cell.row.data)"
          [disabled]="cell.row.data.status !== 'Available'">
          <igx-icon>add_shopping_cart</igx-icon>
          Request
        </button>
      </ng-template>
    </igx-column>
  </igx-grid>

  <!-- Request Dialog -->
  <igx-dialog #requestDialog [closeOnOutsideSelect]="true">
    <div igxDialogTitle>Request Equipment</div>
    <div igxDialogContent>
      @if (selectedEquipment) {
        <div class="dialog-content">
          <h4>{{ selectedEquipment.name }}</h4>
          <p><strong>Type:</strong> {{ selectedEquipment.type }}</p>
          <p><strong>Location:</strong> {{ selectedEquipment.location }}</p>
          <p><strong>Condition:</strong> {{ selectedEquipment.condition }}</p>
          
          <div class="date-inputs">
            <igx-input-group>
              <input igxInput type="datetime-local" [(ngModel)]="requestStartDate" required />
              <label igxLabel>Start Date & Time</label>
            </igx-input-group>
            
            <igx-input-group>
              <input igxInput type="datetime-local" [(ngModel)]="requestEndDate" required />
              <label igxLabel>End Date & Time</label>
            </igx-input-group>
          </div>
          
          <igx-input-group>
            <textarea igxInput [(ngModel)]="requestNotes" rows="3"></textarea>
            <label igxLabel>Notes (Optional)</label>
          </igx-input-group>
        </div>
      }
    </div>
    <div igxDialogActions>
      <button igxButton="flat" (click)="requestDialog.close()">Cancel</button>
      <button 
        igxButton="contained" 
        igxRipple 
        (click)="submitRequest()"
        [disabled]="!isRequestValid()">
        Submit Request
      </button>
    </div>
  </igx-dialog>

  <igx-snackbar #snackbar></igx-snackbar>
</div>